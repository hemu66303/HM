-- XH脚本完整修复版
local Start = tick() -- 启动计时
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local PlayerGui = Players.LocalPlayer:WaitForChild("PlayerGui")
local MarketplaceService = game:GetService("MarketplaceService")
local RbxAnalyticsService = game:GetService("RbxAnalyticsService")

-- ========== 启动动画 ==========
local function createStartupAnimation()
    -- 创建动画屏幕
    local AnimationScreen = Instance.new("ScreenGui")
    AnimationScreen.Name = "StartupAnimation"
    AnimationScreen.ResetOnSpawn = false
    AnimationScreen.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    AnimationScreen.Parent = PlayerGui
    
    -- 黑色背景
    local Background = Instance.new("Frame")
    Background.Name = "Background"
    Background.Size = UDim2.new(1, 0, 1, 0)
    Background.BackgroundColor3 = Color3.new(0, 0, 0)
    Background.BackgroundTransparency = 0
    Background.ZIndex = 10
    Background.Parent = AnimationScreen
    
    -- Logo容器
    local LogoContainer = Instance.new("Frame")
    LogoContainer.Name = "LogoContainer"
    LogoContainer.Size = UDim2.new(0, 300, 0, 200)
    LogoContainer.Position = UDim2.new(0.5, -150, 0.5, -100)
    LogoContainer.BackgroundTransparency = 1
    LogoContainer.ZIndex = 11
    LogoContainer.Parent = AnimationScreen
    
    -- XH Logo
    local LogoLabel = Instance.new("TextLabel")
    LogoLabel.Name = "Logo"
    LogoLabel.Size = UDim2.new(1, 0, 0, 100)
    LogoLabel.Position = UDim2.new(0, 0, 0.2, 0)
    LogoLabel.BackgroundTransparency = 1
    LogoLabel.Text = "XH脚本"
    LogoLabel.TextColor3 = Color3.new(1, 1, 1)
    LogoLabel.TextSize = 40
    LogoLabel.TextScaled = true
    LogoLabel.Font = Enum.Font.SourceSansBold
    LogoLabel.ZIndex = 12
    LogoLabel.Parent = LogoContainer
    
    -- 加载文本
    local LoadingText = Instance.new("TextLabel")
    LoadingText.Name = "LoadingText"
    LoadingText.Size = UDim2.new(1, 0, 0, 30)
    LoadingText.Position = UDim2.new(0, 0, 0.6, 0)
    LoadingText.BackgroundTransparency = 1
    LoadingText.Text = "正在加载..."
    LoadingText.TextColor3 = Color3.new(1, 1, 1)
    LoadingText.TextSize = 18
    LoadingText.Font = Enum.Font.SourceSans
    LoadingText.ZIndex = 12
    LoadingText.Parent = LogoContainer
    
    -- 进度条背景
    local ProgressBarBackground = Instance.new("Frame")
    ProgressBarBackground.Name = "ProgressBarBackground"
    ProgressBarBackground.Size = UDim2.new(0, 200, 0, 8)
    ProgressBarBackground.Position = UDim2.new(0.5, -100, 0.8, 0)
    ProgressBarBackground.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    ProgressBarBackground.ZIndex = 12
    
    -- 进度条背景圆角
    local ProgressBackgroundCorner = Instance.new("UICorner")
    ProgressBackgroundCorner.CornerRadius = UDim.new(1, 0)
    ProgressBackgroundCorner.Parent = ProgressBarBackground
    
    ProgressBarBackground.Parent = LogoContainer
    
    -- 进度条
    local ProgressBar = Instance.new("Frame")
    ProgressBar.Name = "ProgressBar"
    ProgressBar.Size = UDim2.new(0, 0, 1, 0)
    ProgressBar.Position = UDim2.new(0, 0, 0, 0)
    ProgressBar.BackgroundColor3 = Color3.new(0.3, 0.7, 1)
    ProgressBar.ZIndex = 13
    
    -- 进度条圆角
    local ProgressBarCorner = Instance.new("UICorner")
    ProgressBarCorner.CornerRadius = UDim.new(1, 0)
    ProgressBarCorner.Parent = ProgressBar
    
    ProgressBar.Parent = ProgressBarBackground
    
    -- 进度条动画函数
    local function playAnimationSequence()
        -- 淡入Logo
        TweenService:Create(LogoLabel, TweenInfo.new(0.8, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            TextTransparency = 0
        }):Play()
        
        wait(0.3)
        
        -- 淡入加载文本
        TweenService:Create(LoadingText, TweenInfo.new(0.8, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            TextTransparency = 0
        }):Play()
        
        -- 进度条动画
        for i = 1, 100 do
            TweenService:Create(ProgressBar, TweenInfo.new(0.03, Enum.EasingStyle.Linear), {
                Size = UDim2.new(i/100, 0, 1, 0)
            }):Play()
            wait(0.03)
        end
        
        wait(0.5)
        
        -- 淡出动画
        TweenService:Create(LogoContainer, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 1
        }):Play()
        
        TweenService:Create(LogoLabel, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            TextTransparency = 1
        }):Play()
        
        TweenService:Create(LoadingText, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            TextTransparency = 1
        }):Play()
        
        TweenService:Create(ProgressBarBackground, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 1
        }):Play()
        
        TweenService:Create(ProgressBar, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 1
        }):Play()
        
        TweenService:Create(Background, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 1
        }):Play()
        
        wait(0.5)
        
        -- 移除动画屏幕
        AnimationScreen:Destroy()
        
        return true
    end
    
    -- 返回动画函数
    return playAnimationSequence
end

-- ========== 主UI创建 ==========
local function createMainUI()
    -- 手动创建UI
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "XHScriptUI"
    ScreenGui.Parent = PlayerGui

    -- 主窗口（支持拖动）
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainWindow"
    MainFrame.Size = UDim2.new(0, 500, 0, 650)
    MainFrame.Position = UDim2.new(0.5, -250, 0.05, 0)
    MainFrame.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
    MainFrame.BorderSizePixel = 0
    MainFrame.BackgroundTransparency = 1 -- 初始透明

    -- 添加圆角
    local MainFrameCorner = Instance.new("UICorner")
    MainFrameCorner.CornerRadius = UDim.new(0, 8)
    MainFrameCorner.Parent = MainFrame

    MainFrame.ClipsDescendants = true
    MainFrame.Parent = ScreenGui

    -- 窗口标题（拖动区域）
    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Name = "Title"
    TitleLabel.Size = UDim2.new(1, -70, 0, 30)
    TitleLabel.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    TitleLabel.Text = "XH脚本"
    TitleLabel.TextColor3 = Color3.new(1, 1, 1)
    TitleLabel.TextSize = 16
    TitleLabel.BackgroundTransparency = 1 -- 初始透明
    TitleLabel.Parent = MainFrame

    -- 标题栏圆角
    local TitleCorner = Instance.new("UICorner")
    TitleCorner.CornerRadius = UDim.new(0, 8)
    TitleCorner.Parent = TitleLabel

    -- 最小化按钮
    local MinimizeBtn = Instance.new("TextButton")
    MinimizeBtn.Name = "MinimizeBtn"
    MinimizeBtn.Size = UDim2.new(0, 30, 0, 30)
    MinimizeBtn.Position = UDim2.new(1, -60, 0, 0)
    MinimizeBtn.BackgroundColor3 = Color3.new(0.3, 0.3, 0.5)
    MinimizeBtn.Text = "_"
    MinimizeBtn.TextColor3 = Color3.new(1, 1, 1)
    MinimizeBtn.TextSize = 16
    MinimizeBtn.BackgroundTransparency = 1 -- 初始透明

    -- 按钮圆角
    local MinimizeCorner = Instance.new("UICorner")
    MinimizeCorner.CornerRadius = UDim.new(0, 6)
    MinimizeCorner.Parent = MinimizeBtn

    MinimizeBtn.Parent = MainFrame

    -- 关闭按钮
    local CloseBtn = Instance.new("TextButton")
    CloseBtn.Name = "CloseBtn"
    CloseBtn.Size = UDim2.new(0, 30, 0, 30)
    CloseBtn.Position = UDim2.new(1, -30, 0, 0)
    CloseBtn.BackgroundColor3 = Color3.new(0.8, 0.2, 0.2)
    CloseBtn.Text = "X"
    CloseBtn.TextColor3 = Color3.new(1, 1, 1)
    CloseBtn.TextSize = 16
    CloseBtn.BackgroundTransparency = 1 -- 初始透明

    -- 按钮圆角
    local CloseCorner = Instance.new("UICorner")
    CloseCorner.CornerRadius = UDim.new(0, 6)
    CloseCorner.Parent = CloseBtn

    CloseBtn.Parent = MainFrame

    -- 内容区域（包含左右布局）
    local ContentFrame = Instance.new("Frame")
    ContentFrame.Name = "Content"
    ContentFrame.Size = UDim2.new(1, -10, 1, -70)
    ContentFrame.Position = UDim2.new(0, 5, 0, 60)
    ContentFrame.BackgroundColor3 = Color3.new(0.12, 0.12, 0.12)
    ContentFrame.ClipsDescendants = true
    ContentFrame.BackgroundTransparency = 1 -- 初始透明

    -- 内容区域圆角
    local ContentCorner = Instance.new("UICorner")
    ContentCorner.CornerRadius = UDim.new(0, 6)
    ContentCorner.Parent = ContentFrame

    ContentFrame.Parent = MainFrame

    -- 左侧选项栏（占1/3）
    local LeftOptionsFrame = Instance.new("ScrollingFrame")
    LeftOptionsFrame.Name = "LeftOptions"
    LeftOptionsFrame.Size = UDim2.new(0.33, -5, 1, 0)
    LeftOptionsFrame.Position = UDim2.new(0, 0, 0, 0)
    LeftOptionsFrame.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
    LeftOptionsFrame.BorderSizePixel = 0
    LeftOptionsFrame.ScrollBarThickness = 6
    LeftOptionsFrame.ScrollBarImageColor3 = Color3.new(0.5, 0.5, 0.5)
    LeftOptionsFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
    LeftOptionsFrame.BackgroundTransparency = 1 -- 初始透明

    -- 左侧选项栏圆角
    local LeftOptionsCorner = Instance.new("UICorner")
    LeftOptionsCorner.CornerRadius = UDim.new(0, 6)
    LeftOptionsCorner.Parent = LeftOptionsFrame

    LeftOptionsFrame.Parent = ContentFrame

    -- 右侧内容区域（占2/3）
    local RightContentFrame = Instance.new("ScrollingFrame")
    RightContentFrame.Name = "RightContent"
    RightContentFrame.Size = UDim2.new(0.67, -5, 1, 0)
    RightContentFrame.Position = UDim2.new(0.33, 5, 0, 0)
    RightContentFrame.BackgroundColor3 = Color3.new(0.12, 0.12, 0.12)
    RightContentFrame.BorderSizePixel = 0
    RightContentFrame.ScrollBarThickness = 6
    RightContentFrame.ScrollBarImageColor3 = Color3.new(0.5, 0.5, 0.5)
    RightContentFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
    RightContentFrame.BackgroundTransparency = 1 -- 初始透明

    -- 右侧内容区域圆角
    local RightContentCorner = Instance.new("UICorner")
    RightContentCorner.CornerRadius = UDim.new(0, 6)
    RightContentCorner.Parent = RightContentFrame

    RightContentFrame.Parent = ContentFrame

    -- 左侧选项按钮容器
    local OptionsContainer = Instance.new("Frame")
    OptionsContainer.Name = "OptionsContainer"
    OptionsContainer.Size = UDim2.new(1, 0, 0, 0)
    OptionsContainer.AutomaticSize = Enum.AutomaticSize.Y
    OptionsContainer.BackgroundTransparency = 1
    OptionsContainer.Parent = LeftOptionsFrame

    -- 公告选项按钮
    local Option1Btn = Instance.new("TextButton")
    Option1Btn.Name = "Option1"
    Option1Btn.Size = UDim2.new(0.9, 0, 0, 40)
    Option1Btn.Position = UDim2.new(0.05, 0, 0, 10)
    Option1Btn.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
    Option1Btn.Text = "公告"
    Option1Btn.TextColor3 = Color3.new(1, 1, 1)
    Option1Btn.TextSize = 14
    Option1Btn.BackgroundTransparency = 1 -- 初始透明

    -- 按钮圆角
    local Option1Corner = Instance.new("UICorner")
    Option1Corner.CornerRadius = UDim.new(0, 6)
    Option1Corner.Parent = Option1Btn

    Option1Btn.Parent = OptionsContainer

    -- 飞行功能选项按钮
    local Option2Btn = Instance.new("TextButton")
    Option2Btn.Name = "Option2"
    Option2Btn.Size = UDim2.new(0.9, 0, 0, 40)
    Option2Btn.Position = UDim2.new(0.05, 0, 0, 60)
    Option2Btn.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
    Option2Btn.Text = "飞行功能"
    Option2Btn.TextColor3 = Color3.new(1, 1, 1)
    Option2Btn.TextSize = 14
    Option2Btn.BackgroundTransparency = 1 -- 初始透明

    -- 按钮圆角
    local Option2Corner = Instance.new("UICorner")
    Option2Corner.CornerRadius = UDim.new(0, 6)
    Option2Corner.Parent = Option2Btn

    Option2Btn.Parent = OptionsContainer

    -- 步行速度/跳跃高度选项按钮
    local Option3Btn = Instance.new("TextButton")
    Option3Btn.Name = "Option3"
    Option3Btn.Size = UDim2.new(0.9, 0, 0, 40)
    Option3Btn.Position = UDim2.new(0.05, 0, 0, 110)
    Option3Btn.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
    Option3Btn.Text = "速度/跳跃"
    Option3Btn.TextColor3 = Color3.new(1, 1, 1)
    Option3Btn.TextSize = 14
    Option3Btn.BackgroundTransparency = 1 -- 初始透明

    -- 按钮圆角
    local Option3Corner = Instance.new("UICorner")
    Option3Corner.CornerRadius = UDim.new(0, 6)
    Option3Corner.Parent = Option3Btn

    Option3Btn.Parent = OptionsContainer

    -- 血量回复选项按钮
    local Option4Btn = Instance.new("TextButton")
    Option4Btn.Name = "Option4"
    Option4Btn.Size = UDim2.new(0.9, 0, 0, 40)
    Option4Btn.Position = UDim2.new(0.05, 0, 0, 160)
    Option4Btn.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
    Option4Btn.Text = "血量回复"
    Option4Btn.TextColor3 = Color3.new(1, 1, 1)
    Option4Btn.TextSize = 14
    Option4Btn.BackgroundTransparency = 1 -- 初始透明

    -- 按钮圆角
    local Option4Corner = Instance.new("UICorner")
    Option4Corner.CornerRadius = UDim.new(0, 6)
    Option4Corner.Parent = Option4Btn

    Option4Btn.Parent = OptionsContainer

    -- 透视选项按钮
    local Option5Btn = Instance.new("TextButton")
    Option5Btn.Name = "Option5"
    Option5Btn.Size = UDim2.new(0.9, 0, 0, 40)
    Option5Btn.Position = UDim2.new(0.05, 0, 0, 210)
    Option5Btn.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
    Option5Btn.Text = "透视"
    Option5Btn.TextColor3 = Color3.new(1, 1, 1)
    Option5Btn.TextSize = 14
    Option5Btn.BackgroundTransparency = 1 -- 初始透明

    -- 按钮圆角
    local Option5Corner = Instance.new("UICorner")
    Option5Corner.CornerRadius = UDim.new(0, 6)
    Option5Corner.Parent = Option5Btn

    Option5Btn.Parent = OptionsContainer

    -- 光影画质选项按钮
    local Option6Btn = Instance.new("TextButton")
    Option6Btn.Name = "Option6"
    Option6Btn.Size = UDim2.new(0.9, 0, 0, 40)
    Option6Btn.Position = UDim2.new(0.05, 0, 0, 260)
    Option6Btn.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
    Option6Btn.Text = "光影画质"
    Option6Btn.TextColor3 = Color3.new(1, 1, 1)
    Option6Btn.TextSize = 14
    Option6Btn.BackgroundTransparency = 1 -- 初始透明

    -- 按钮圆角
    local Option6Corner = Instance.new("UICorner")
    Option6Corner.CornerRadius = UDim.new(0, 6)
    Option6Corner.Parent = Option6Btn

    Option6Btn.Parent = OptionsContainer

    -- 高级功能选项按钮
    local Option7Btn = Instance.new("TextButton")
    Option7Btn.Name = "Option7"
    Option7Btn.Size = UDim2.new(0.9, 0, 0, 40)
    Option7Btn.Position = UDim2.new(0.05, 0, 0, 310)
    Option7Btn.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
    Option7Btn.Text = "高级功能"
    Option7Btn.TextColor3 = Color3.new(1, 1, 1)
    Option7Btn.TextSize = 14
    Option7Btn.BackgroundTransparency = 1 -- 初始透明

    -- 按钮圆角
    local Option7Corner = Instance.new("UICorner")
    Option7Corner.CornerRadius = UDim.new(0, 6)
    Option7Corner.Parent = Option7Btn

    Option7Btn.Parent = OptionsContainer

    -- 右侧内容容器
    local ContentContainer = Instance.new("Frame")
    ContentContainer.Name = "ContentContainer"
    ContentContainer.Size = UDim2.new(1, 0, 0, 0)
    ContentContainer.AutomaticSize = Enum.AutomaticSize.Y
    ContentContainer.BackgroundTransparency = 1
    ContentContainer.Parent = RightContentFrame

    -- ========== 公告内容 ==========
    local NoticeFrame = Instance.new("Frame")
    NoticeFrame.Name = "NoticeContent"
    NoticeFrame.Size = UDim2.new(1, 0, 0, 450)
    NoticeFrame.BackgroundTransparency = 1
    NoticeFrame.Parent = ContentContainer

    -- 公告标题
    local NoticeTitle = Instance.new("TextLabel")
    NoticeTitle.Name = "NoticeTitle"
    NoticeTitle.Size = UDim2.new(1, 0, 0, 30)
    NoticeTitle.Position = UDim2.new(0, 0, 0, 10)
    NoticeTitle.BackgroundTransparency = 1
    NoticeTitle.Text = "公告"
    NoticeTitle.TextColor3 = Color3.new(1, 1, 1)
    NoticeTitle.TextSize = 20
    NoticeTitle.Font = Enum.Font.SourceSansBold
    NoticeTitle.Parent = NoticeFrame

    -- 公告滚动框
    local NoticeScrollFrame = Instance.new("ScrollingFrame")
    NoticeScrollFrame.Name = "NoticeScroll"
    NoticeScrollFrame.Size = UDim2.new(1, -20, 0, 150)
    NoticeScrollFrame.Position = UDim2.new(0, 10, 0, 50)
    NoticeScrollFrame.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
    NoticeScrollFrame.BorderSizePixel = 0
    NoticeScrollFrame.ScrollBarThickness = 6
    NoticeScrollFrame.ScrollBarImageColor3 = Color3.new(0.5, 0.5, 0.5)
    NoticeScrollFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
    NoticeScrollFrame.Parent = NoticeFrame

    local NoticeLabel = Instance.new("TextLabel")
    NoticeLabel.Name = "Notice"
    NoticeLabel.Size = UDim2.new(1, 0, 0, 0)
    NoticeLabel.AutomaticSize = Enum.AutomaticSize.Y
    NoticeLabel.Position = UDim2.new(0, 0, 0, 0)
    NoticeLabel.BackgroundTransparency = 1
    NoticeLabel.Text = "开发时间:2025年11月8日\n\n本脚本专为研发吃吃世界脚本为生。为了维护网络秩序和广大玩家的游戏体验，请大家合理使用脚本。若您在使用脚本的过程中遇到了一些BUG或问题，可以及时向我们脚本工作室反馈。为了保证脚本的安全性，未经脚本作者同意不得擅自宣传或倒卖。\n\n脚本功能:\n1. 飞行功能\n2. 无敌模式\n3. 血量回复\n4. 速度/跳跃设置\n5. 透视功能\n6. 光影画质\n7. 高级功能\n\n注意事项:\n- 请合理使用脚本功能\n- 不要影响其他玩家游戏体验\n- 遇到问题及时反馈"
    NoticeLabel.TextColor3 = Color3.new(1, 1, 1)
    NoticeLabel.TextSize = 12
    NoticeLabel.TextWrapped = true
    NoticeLabel.TextXAlignment = Enum.TextXAlignment.Left
    NoticeLabel.TextYAlignment = Enum.TextYAlignment.Top
    NoticeLabel.Parent = NoticeScrollFrame

    -- 系统信息标题
    local SystemInfoTitle = Instance.new("TextLabel")
    SystemInfoTitle.Name = "SystemInfoTitle"
    SystemInfoTitle.Size = UDim2.new(1, -20, 0, 30)
    SystemInfoTitle.Position = UDim2.new(0, 10, 0, 210)
    SystemInfoTitle.BackgroundTransparency = 1
    SystemInfoTitle.Text = "系统信息"
    SystemInfoTitle.TextColor3 = Color3.new(1, 1, 1)
    SystemInfoTitle.TextSize = 16
    SystemInfoTitle.TextXAlignment = Enum.TextXAlignment.Left
    SystemInfoTitle.Font = Enum.Font.SourceSansBold
    SystemInfoTitle.Parent = NoticeFrame

    -- 创建信息标签的函数
    local function createInfoLabel(parent, text, position)
        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(1, -20, 0, 20)
        label.Position = position
        label.BackgroundTransparency = 1
        label.Text = text
        label.TextColor3 = Color3.new(0.8, 0.8, 0.8)
        label.TextSize = 12
        label.TextXAlignment = Enum.TextXAlignment.Left
        label.Parent = parent
        return label
    end

    -- 获取并显示系统信息
    local function getSystemInfo()
        local player = Players.LocalPlayer
        local info = {}
        
        -- 注入器信息（简化版本）
        info.injector = "XH Script v1.5"
        
        -- 服务器信息
        local success, gameInfo = pcall(function()
            return MarketplaceService:GetProductInfo(game.PlaceId)
        end)
        info.serverName = success and gameInfo.Name or "未知"
        
        -- 服务器ID
        info.serverId = tostring(game.GameId)
        
        -- 用户名
        info.username = player.DisplayName
        
        -- 账号年龄
        info.accountAge = player.AccountAge .. "天"
        
        -- 会员状态
        info.membership = player.MembershipType == Enum.MembershipType.Premium and "有会员" or "没有会员"
        
        -- 语言
        info.language = player.LocaleId
        
        -- 设备类型
        local deviceType = "未知设备"
        if UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled and not UserInputService.MouseEnabled then
            deviceType = "移动设备"
        elseif not UserInputService.TouchEnabled and UserInputService.KeyboardEnabled and UserInputService.MouseEnabled then
            deviceType = "电脑"
        elseif UserInputService.TouchEnabled and UserInputService.KeyboardEnabled and UserInputService.MouseEnabled then
            deviceType = "带触摸屏的电脑"
        end
        info.deviceType = deviceType
        
        -- 客户端ID
        info.clientId = RbxAnalyticsService:GetClientId()
        
        return info
    end

    -- 显示系统信息
    local systemInfo = getSystemInfo()
    local yOffset = 250

    createInfoLabel(NoticeFrame, "脚本名称: " .. systemInfo.injector, UDim2.new(0, 10, 0, yOffset))
    yOffset = yOffset + 25

    createInfoLabel(NoticeFrame, "服务器名称: " .. systemInfo.serverName, UDim2.new(0, 10, 0, yOffset))
    yOffset = yOffset + 25

    createInfoLabel(NoticeFrame, "当前服务器ID: " .. systemInfo.serverId, UDim2.new(0, 10, 0, yOffset))
    yOffset = yOffset + 25

    createInfoLabel(NoticeFrame, "你的用户名: " .. systemInfo.username, UDim2.new(0, 10, 0, yOffset))
    yOffset = yOffset + 25

    createInfoLabel(NoticeFrame, "你的账号年龄: " .. systemInfo.accountAge, UDim2.new(0, 10, 0, yOffset))
    yOffset = yOffset + 25

    createInfoLabel(NoticeFrame, "会员状态: " .. systemInfo.membership, UDim2.new(0, 10, 0, yOffset))
    yOffset = yOffset + 25

    createInfoLabel(NoticeFrame, "语言: " .. systemInfo.language, UDim2.new(0, 10, 0, yOffset))
    yOffset = yOffset + 25

    createInfoLabel(NoticeFrame, "设备类型: " .. systemInfo.deviceType, UDim2.new(0, 10, 0, yOffset))
    yOffset = yOffset + 25

    createInfoLabel(NoticeFrame, "客户端ID: " .. systemInfo.clientId, UDim2.new(0, 10, 0, yOffset))

    -- ========== 飞行功能内容 ==========
    local FlyFrame = Instance.new("Frame")
    FlyFrame.Name = "FlyContent"
    FlyFrame.Size = UDim2.new(1, 0, 0, 200)
    FlyFrame.BackgroundTransparency = 1
    FlyFrame.Visible = false
    FlyFrame.Parent = ContentContainer

    -- 飞行功能按钮
    local FlyBtn = Instance.new("TextButton")
    FlyBtn.Name = "FlyBtn"
    FlyBtn.Size = UDim2.new(0.9, 0, 0, 60)
    FlyBtn.Position = UDim2.new(0.05, 0, 0, 50)
    FlyBtn.BackgroundColor3 = Color3.new(0.3, 0.5, 0.8)
    FlyBtn.Text = "开启飞行"
    FlyBtn.TextColor3 = Color3.new(1, 1, 1)
    FlyBtn.TextSize = 18
    FlyBtn.BackgroundTransparency = 1

    -- 按钮圆角
    local FlyCorner = Instance.new("UICorner")
    FlyCorner.CornerRadius = UDim.new(0, 10)
    FlyCorner.Parent = FlyBtn

    FlyBtn.Parent = FlyFrame

    -- 飞行状态显示
    local FlyStatus = Instance.new("TextLabel")
    FlyStatus.Name = "FlyStatus"
    FlyStatus.Size = UDim2.new(1, 0, 0, 30)
    FlyStatus.Position = UDim2.new(0, 0, 0, 130)
    FlyStatus.BackgroundTransparency = 1
    FlyStatus.Text = "飞行功能未激活"
    FlyStatus.TextColor3 = Color3.new(1, 1, 1)
    FlyStatus.TextSize = 14
    FlyStatus.Parent = FlyFrame

    -- ========== 速度/跳跃内容 ==========
    local SpeedJumpFrame = Instance.new("Frame")
    SpeedJumpFrame.Name = "SpeedJumpContent"
    SpeedJumpFrame.Size = UDim2.new(1, 0, 0, 300)
    SpeedJumpFrame.BackgroundTransparency = 1
    SpeedJumpFrame.Visible = false
    SpeedJumpFrame.Parent = ContentContainer

    -- 速度/跳跃标题
    local SpeedJumpTitle = Instance.new("TextLabel")
    SpeedJumpTitle.Name = "SpeedJumpTitle"
    SpeedJumpTitle.Size = UDim2.new(1, 0, 0, 30)
    SpeedJumpTitle.Position = UDim2.new(0, 0, 0, 10)
    SpeedJumpTitle.BackgroundTransparency = 1
    SpeedJumpTitle.Text = "速度/跳跃设置"
    SpeedJumpTitle.TextColor3 = Color3.new(1, 1, 1)
    SpeedJumpTitle.TextSize = 16
    SpeedJumpTitle.TextWrapped = true
    SpeedJumpTitle.Parent = SpeedJumpFrame

    -- 速度设置
    local SpeedLabel = Instance.new("TextLabel")
    SpeedLabel.Name = "SpeedLabel"
    SpeedLabel.Size = UDim2.new(0.7, 0, 0, 20)
    SpeedLabel.Position = UDim2.new(0.05, 0, 0, 60)
    SpeedLabel.BackgroundTransparency = 1
    SpeedLabel.Text = "移动速度 (默认16):"
    SpeedLabel.TextColor3 = Color3.new(1, 1, 1)
    SpeedLabel.TextSize = 12
    SpeedLabel.TextXAlignment = Enum.TextXAlignment.Left
    SpeedLabel.Parent = SpeedJumpFrame

    local SpeedTextBox = Instance.new("TextBox")
    SpeedTextBox.Name = "SpeedTextBox"
    SpeedTextBox.Size = UDim2.new(0.25, 0, 0, 20)
    SpeedTextBox.Position = UDim2.new(0.7, 0, 0, 60)
    SpeedTextBox.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    SpeedTextBox.BorderColor3 = Color3.new(0.4, 0.4, 0.4)
    SpeedTextBox.Text = "16"
    SpeedTextBox.TextColor3 = Color3.new(1, 1, 1)
    SpeedTextBox.TextSize = 12
    SpeedTextBox.BackgroundTransparency = 1

    -- 文本框圆角
    local SpeedCorner = Instance.new("UICorner")
    SpeedCorner.CornerRadius = UDim.new(0, 4)
    SpeedCorner.Parent = SpeedTextBox

    SpeedTextBox.Parent = SpeedJumpFrame

    -- 跳跃高度设置
    local JumpLabel = Instance.new("TextLabel")
    JumpLabel.Name = "JumpLabel"
    JumpLabel.Size = UDim2.new(0.7, 0, 0, 20)
    JumpLabel.Position = UDim2.new(0.05, 0, 0, 90)
    JumpLabel.BackgroundTransparency = 1
    JumpLabel.Text = "跳跃高度 (默认50):"
    JumpLabel.TextColor3 = Color3.new(1, 1, 1)
    JumpLabel.TextSize = 12
    JumpLabel.TextXAlignment = Enum.TextXAlignment.Left
    JumpLabel.Parent = SpeedJumpFrame

    local JumpTextBox = Instance.new("TextBox")
    JumpTextBox.Name = "JumpTextBox"
    JumpTextBox.Size = UDim2.new(0.25, 0, 0, 20)
    JumpTextBox.Position = UDim2.new(0.7, 0, 0, 90)
    JumpTextBox.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    JumpTextBox.BorderColor3 = Color3.new(0.4, 0.4, 0.4)
    JumpTextBox.Text = "50"
    JumpTextBox.TextColor3 = Color3.new(1, 1, 1)
    JumpTextBox.TextSize = 12
    JumpTextBox.BackgroundTransparency = 1

    -- 文本框圆角
    local JumpCorner = Instance.new("UICorner")
    JumpCorner.CornerRadius = UDim.new(0, 4)
    JumpCorner.Parent = JumpTextBox

    JumpTextBox.Parent = SpeedJumpFrame

    -- 启用按钮
    local ApplyBtn = Instance.new("TextButton")
    ApplyBtn.Name = "ApplyBtn"
    ApplyBtn.Size = UDim2.new(0.9, 0, 0, 35)
    ApplyBtn.Position = UDim2.new(0.05, 0, 0, 130)
    ApplyBtn.BackgroundColor3 = Color3.new(0.2, 0.6, 0.2)
    ApplyBtn.Text = "启用设置"
    ApplyBtn.TextColor3 = Color3.new(1, 1, 1)
    ApplyBtn.TextSize = 14
    ApplyBtn.BackgroundTransparency = 1

    -- 按钮圆角
    local ApplyCorner = Instance.new("UICorner")
    ApplyCorner.CornerRadius = UDim.new(0, 6)
    ApplyCorner.Parent = ApplyBtn

    ApplyBtn.Parent = SpeedJumpFrame

    -- 状态显示
    local StatusLabel = Instance.new("TextLabel")
    StatusLabel.Name = "StatusLabel"
    StatusLabel.Size = UDim2.new(1, 0, 0, 30)
    StatusLabel.Position = UDim2.new(0, 0, 0, 180)
    StatusLabel.BackgroundTransparency = 1
    StatusLabel.Text = "等待设置..."
    StatusLabel.TextColor3 = Color3.new(1, 1, 1)
    StatusLabel.TextSize = 12
    StatusLabel.Parent = SpeedJumpFrame

    -- ========== 血量回复内容 ==========
    local HealthRegenFrame = Instance.new("Frame")
    HealthRegenFrame.Name = "HealthRegenContent"
    HealthRegenFrame.Size = UDim2.new(1, 0, 0, 350)
    HealthRegenFrame.BackgroundTransparency = 1
    HealthRegenFrame.Visible = false
    HealthRegenFrame.Parent = ContentContainer

    -- 血量回复标题
    local HealthRegenTitle = Instance.new("TextLabel")
    HealthRegenTitle.Name = "HealthRegenTitle"
    HealthRegenTitle.Size = UDim2.new(1, 0, 0, 30)
    HealthRegenTitle.Position = UDim2.new(0, 0, 0, 10)
    HealthRegenTitle.BackgroundTransparency = 1
    HealthRegenTitle.Text = "血量回复设置"
    HealthRegenTitle.TextColor3 = Color3.new(1, 1, 1)
    HealthRegenTitle.TextSize = 16
    HealthRegenTitle.TextWrapped = true
    HealthRegenTitle.Parent = HealthRegenFrame

    -- 血量回复描述
    local HealthRegenDescription = Instance.new("TextLabel")
    HealthRegenDescription.Name = "HealthRegenDescription"
    HealthRegenDescription.Size = UDim2.new(1, -20, 0, 50)
    HealthRegenDescription.Position = UDim2.new(0, 10, 0, 50)
    HealthRegenDescription.BackgroundTransparency = 1
    HealthRegenDescription.Text = "开启后角色会自动回复血量，可以在下方设置回复速度。"
    HealthRegenDescription.TextColor3 = Color3.new(0.8, 0.8, 0.8)
    HealthRegenDescription.TextSize = 12
    HealthRegenDescription.TextWrapped = true
    HealthRegenDescription.Parent = HealthRegenFrame

    -- 血量回复按钮
    local HealthRegenBtn = Instance.new("TextButton")
    HealthRegenBtn.Name = "HealthRegenBtn"
    HealthRegenBtn.Size = UDim2.new(0.9, 0, 0, 35)
    HealthRegenBtn.Position = UDim2.new(0.05, 0, 0, 110)
    HealthRegenBtn.BackgroundColor3 = Color3.new(0.8, 0.3, 0.3)
    HealthRegenBtn.Text = "血量回复: 关闭"
    HealthRegenBtn.TextColor3 = Color3.new(1, 1, 1)
    HealthRegenBtn.TextSize = 14
    HealthRegenBtn.BackgroundTransparency = 1

    -- 按钮圆角
    local HealthRegenCorner = Instance.new("UICorner")
    HealthRegenCorner.CornerRadius = UDim.new(0, 6)
    HealthRegenCorner.Parent = HealthRegenBtn

    HealthRegenBtn.Parent = HealthRegenFrame

    -- 血量回复状态显示
    local HealthRegenStatus = Instance.new("TextLabel")
    HealthRegenStatus.Name = "HealthRegenStatus"
    HealthRegenStatus.Size = UDim2.new(1, 0, 0, 30)
    HealthRegenStatus.Position = UDim2.new(0, 0, 0, 155)
    HealthRegenStatus.BackgroundTransparency = 1
    HealthRegenStatus.Text = "血量回复未激活"
    HealthRegenStatus.TextColor3 = Color3.new(1, 1, 1)
    HealthRegenStatus.TextSize = 12
    HealthRegenStatus.Parent = HealthRegenFrame

    -- 回复速度设置
    local RegenSpeedLabel = Instance.new("TextLabel")
    RegenSpeedLabel.Name = "RegenSpeedLabel"
    RegenSpeedLabel.Size = UDim2.new(0.7, 0, 0, 20)
    RegenSpeedLabel.Position = UDim2.new(0.05, 0, 0, 195)
    RegenSpeedLabel.BackgroundTransparency = 1
    RegenSpeedLabel.Text = "回复速度 (每秒血量):"
    RegenSpeedLabel.TextColor3 = Color3.new(1, 1, 1)
    RegenSpeedLabel.TextSize = 12
    RegenSpeedLabel.TextXAlignment = Enum.TextXAlignment.Left
    RegenSpeedLabel.Parent = HealthRegenFrame

    local RegenSpeedTextBox = Instance.new("TextBox")
    RegenSpeedTextBox.Name = "RegenSpeedTextBox"
    RegenSpeedTextBox.Size = UDim2.new(0.25, 0, 0, 20)
    RegenSpeedTextBox.Position = UDim2.new(0.7, 0, 0, 195)
    RegenSpeedTextBox.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    RegenSpeedTextBox.BorderColor3 = Color3.new(0.4, 0.4, 0.4)
    RegenSpeedTextBox.Text = "5"
    RegenSpeedTextBox.TextColor3 = Color3.new(1, 1, 1)
    RegenSpeedTextBox.TextSize = 12
    RegenSpeedTextBox.BackgroundTransparency = 1

    -- 文本框圆角
    local RegenSpeedCorner = Instance.new("UICorner")
    RegenSpeedCorner.CornerRadius = UDim.new(0, 4)
    RegenSpeedCorner.Parent = RegenSpeedTextBox

    RegenSpeedTextBox.Parent = HealthRegenFrame

    -- 无敌模式按钮
    local GodModeBtn = Instance.new("TextButton")
    GodModeBtn.Name = "GodModeBtn"
    GodModeBtn.Size = UDim2.new(0.9, 0, 0, 35)
    GodModeBtn.Position = UDim2.new(0.05, 0, 0, 230)
    GodModeBtn.BackgroundColor3 = Color3.new(0.8, 0.2, 0.2)
    GodModeBtn.Text = "无敌模式: 关闭"
    GodModeBtn.TextColor3 = Color3.new(1, 1, 1)
    GodModeBtn.TextSize = 14
    GodModeBtn.BackgroundTransparency = 1

    -- 按钮圆角
    local GodModeCorner = Instance.new("UICorner")
    GodModeCorner.CornerRadius = UDim.new(0, 6)
    GodModeCorner.Parent = GodModeBtn

    GodModeBtn.Parent = HealthRegenFrame

    -- 无敌模式状态显示
    local GodModeStatus = Instance.new("TextLabel")
    GodModeStatus.Name = "GodModeStatus"
    GodModeStatus.Size = UDim2.new(1, 0, 0, 30)
    GodModeStatus.Position = UDim2.new(0, 0, 0, 275)
    GodModeStatus.BackgroundTransparency = 1
    GodModeStatus.Text = "无敌模式未激活"
    GodModeStatus.TextColor3 = Color3.new(1, 1, 1)
    GodModeStatus.TextSize = 12
    GodModeStatus.Parent = HealthRegenFrame

    -- ========== 透视内容 ==========
    local ESPFrame = Instance.new("Frame")
    ESPFrame.Name = "ESPContent"
    ESPFrame.Size = UDim2.new(1, 0, 0, 300)
    ESPFrame.BackgroundTransparency = 1
    ESPFrame.Visible = false
    ESPFrame.Parent = ContentContainer

    -- 透视功能标题
    local ESPTitle = Instance.new("TextLabel")
    ESPTitle.Name = "ESPTitle"
    ESPTitle.Size = UDim2.new(1, 0, 0, 30)
    ESPTitle.Position = UDim2.new(0, 0, 0, 10)
    ESPTitle.BackgroundTransparency = 1
    ESPTitle.Text = "透视功能设置"
    ESPTitle.TextColor3 = Color3.new(1, 1, 1)
    ESPTitle.TextSize = 16
    ESPTitle.TextWrapped = true
    ESPTitle.Parent = ESPFrame

    -- 透视功能描述
    local ESPDescription = Instance.new("TextLabel")
    ESPDescription.Name = "ESPDescription"
    ESPDescription.Size = UDim2.new(1, -20, 0, 50)
    ESPDescription.Position = UDim2.new(0, 10, 0, 50)
    ESPDescription.BackgroundTransparency = 1
    ESPDescription.Text = "开启透视功能可以看到其他玩家的位置和名字。"
    ESPDescription.TextColor3 = Color3.new(0.8, 0.8, 0.8)
    ESPDescription.TextSize = 12
    ESPDescription.TextWrapped = true
    ESPDescription.Parent = ESPFrame

    -- 射线功能开关
    local RayToggle = Instance.new("TextButton")
    RayToggle.Name = "RayToggle"
    RayToggle.Size = UDim2.new(0.9, 0, 0, 30)
    RayToggle.Position = UDim2.new(0.05, 0, 0, 110)
    RayToggle.BackgroundColor3 = Color3.new(0.3, 0.3, 0.5)
    RayToggle.Text = "射线功能: 关闭"
    RayToggle.TextColor3 = Color3.new(1, 1, 1)
    RayToggle.TextSize = 14
    RayToggle.BackgroundTransparency = 1

    -- 按钮圆角
    local RayCorner = Instance.new("UICorner")
    RayCorner.CornerRadius = UDim.new(0, 6)
    RayCorner.Parent = RayToggle

    RayToggle.Parent = ESPFrame

    -- 显示名字开关
    local NameToggle = Instance.new("TextButton")
    NameToggle.Name = "NameToggle"
    NameToggle.Size = UDim2.new(0.9, 0, 0, 30)
    NameToggle.Position = UDim2.new(0.05, 0, 0, 150)
    NameToggle.BackgroundColor3 = Color3.new(0.3, 0.3, 0.5)
    NameToggle.Text = "显示名字: 关闭"
    NameToggle.TextColor3 = Color3.new(1, 1, 1)
    NameToggle.TextSize = 14
    NameToggle.BackgroundTransparency = 1

    -- 按钮圆角
    local NameCorner = Instance.new("UICorner")
    NameCorner.CornerRadius = UDim.new(0, 6)
    NameCorner.Parent = NameToggle

    NameToggle.Parent = ESPFrame

    -- 3D框开关
    local BoxToggle = Instance.new("TextButton")
    BoxToggle.Name = "BoxToggle"
    BoxToggle.Size = UDim2.new(0.9, 0, 0, 30)
    BoxToggle.Position = UDim2.new(0.05, 0, 0, 190)
    BoxToggle.BackgroundColor3 = Color3.new(0.3, 0.3, 0.5)
    BoxToggle.Text = "3D框: 关闭"
    BoxToggle.TextColor3 = Color3.new(1, 1, 1)
    BoxToggle.TextSize = 14
    BoxToggle.BackgroundTransparency = 1

    -- 按钮圆角
    local BoxCorner = Instance.new("UICorner")
    BoxCorner.CornerRadius = UDim.new(0, 6)
    BoxCorner.Parent = BoxToggle

    BoxToggle.Parent = ESPFrame

    -- 透视状态显示
    local ESPStatus = Instance.new("TextLabel")
    ESPStatus.Name = "ESPStatus"
    ESPStatus.Size = UDim2.new(1, 0, 0, 50)
    ESPStatus.Position = UDim2.new(0, 0, 0, 230)
    ESPStatus.BackgroundTransparency = 1
    ESPStatus.Text = "透视功能准备就绪"
    ESPStatus.TextColor3 = Color3.new(1, 1, 1)
    ESPStatus.TextSize = 12
    ESPStatus.TextWrapped = true
    ESPStatus.Parent = ESPFrame

    -- ========== 光影画质内容 ==========
    local GraphicsFrame = Instance.new("Frame")
    GraphicsFrame.Name = "GraphicsContent"
    GraphicsFrame.Size = UDim2.new(1, 0, 0, 400)
    GraphicsFrame.BackgroundTransparency = 1
    GraphicsFrame.Visible = false
    GraphicsFrame.Parent = ContentContainer

    -- 光影画质标题
    local GraphicsTitle = Instance.new("TextLabel")
    GraphicsTitle.Name = "GraphicsTitle"
    GraphicsTitle.Size = UDim2.new(1, 0, 0, 30)
    GraphicsTitle.Position = UDim2.new(0, 0, 0, 10)
    GraphicsTitle.BackgroundTransparency = 1
    GraphicsTitle.Text = "光影画质设置"
    GraphicsTitle.TextColor3 = Color3.new(1, 1, 1)
    GraphicsTitle.TextSize = 16
    GraphicsTitle.TextWrapped = true
    GraphicsTitle.Parent = GraphicsFrame

    -- 光影画质描述
    local GraphicsDescription = Instance.new("TextLabel")
    GraphicsDescription.Name = "GraphicsDescription"
    GraphicsDescription.Size = UDim2.new(1, -20, 0, 60)
    GraphicsDescription.Position = UDim2.new(0, 10, 0, 50)
    GraphicsDescription.BackgroundTransparency = 1
    GraphicsDescription.Text = "选择不同的光影画质效果来提升游戏视觉效果。注意：部分效果可能影响游戏性能。"
    GraphicsDescription.TextColor3 = Color3.new(0.8, 0.8, 0.8)
    GraphicsDescription.TextSize = 12
    GraphicsDescription.TextWrapped = true
    GraphicsDescription.Parent = GraphicsFrame

    -- 创建光影画质按钮的函数
    local function createGraphicsButton(parent, text, position, scriptUrl)
        local button = Instance.new("TextButton")
        button.Size = UDim2.new(0.9, 0, 0, 35)
        button.Position = position
        button.BackgroundColor3 = Color3.new(0.4, 0.4, 0.6)
        button.Text = text
        button.TextColor3 = Color3.new(1, 1, 1)
        button.TextSize = 14
        button.BackgroundTransparency = 1
        
        -- 按钮圆角
        local buttonCorner = Instance.new("UICorner")
        buttonCorner.CornerRadius = UDim.new(0, 6)
        buttonCorner.Parent = button
        
        button.MouseButton1Click:Connect(function()
            if scriptUrl then
                -- 加载对应的光影脚本
                local success, errorMsg = pcall(function()
                    loadstring(game:HttpGet(scriptUrl))()
                end)
                
                if success then
                    -- 显示成功消息
                    local tempLabel = Instance.new("TextLabel")
                    tempLabel.Size = UDim2.new(1, 0, 0, 25)
                    tempLabel.Position = UDim2.new(0, 0, 0, 380)
                    tempLabel.BackgroundTransparency = 1
                    tempLabel.Text = text .. " 已启用"
                    tempLabel.TextColor3 = Color3.new(0, 1, 0)
                    tempLabel.TextSize = 12
                    tempLabel.Parent = GraphicsFrame
                    
                    -- 3秒后移除消息
                    wait(3)
                    tempLabel:Destroy()
                else
                    -- 显示错误消息
                    local tempLabel = Instance.new("TextLabel")
                    tempLabel.Size = UDim2.new(1, 0, 0, 25)
                    tempLabel.Position = UDim2.new(0, 0, 0, 380)
                    tempLabel.BackgroundTransparency = 1
                    tempLabel.Text = "加载失败: " .. errorMsg
                    tempLabel.TextColor3 = Color3.new(1, 0, 0)
                    tempLabel.TextSize = 12
                    tempLabel.Parent = GraphicsFrame
                    
                    -- 3秒后移除消息
                    wait(3)
                    tempLabel:Destroy()
                end
            end
        end)
        
        button.Parent = parent
        return button
    end

    -- 创建光影画质按钮
    local yPos = 120
    createGraphicsButton(GraphicsFrame, "光影", UDim2.new(0.05, 0, 0, yPos), "https://raw.githubusercontent.com/MZEEN2424/Graphics/main/Graphics.xml")
    yPos = yPos + 45

    createGraphicsButton(GraphicsFrame, "超高画质", UDim2.new(0.05, 0, 0, yPos), "https://pastebin.com/raw/jHBfJYmS")
    yPos = yPos + 45

    createGraphicsButton(GraphicsFrame, "光影v4", UDim2.new(0.05, 0, 0, yPos), "https://raw.githubusercontent.com/MZEEN2424/Graphics/main/Graphics.xml")
    yPos = yPos + 45

    createGraphicsButton(GraphicsFrame, "光影浅", UDim2.new(0.05, 0, 0, yPos), "https://pastebin.com/raw/jHBfJYmS")
    yPos = yPos + 45

    createGraphicsButton(GraphicsFrame, "光影深", UDim2.new(0.05, 0, 0, yPos), "https://raw.githubusercontent.com/MZEEN2424/Graphics/main/Graphics.xml")

    -- 状态显示
    local GraphicsStatus = Instance.new("TextLabel")
    GraphicsStatus.Name = "GraphicsStatus"
    GraphicsStatus.Size = UDim2.new(1, 0, 0, 40)
    GraphicsStatus.Position = UDim2.new(0, 0, 0, 350)
    GraphicsStatus.BackgroundTransparency = 1
    GraphicsStatus.Text = "选择光影画质效果"
    GraphicsStatus.TextColor3 = Color3.new(1, 1, 1)
    GraphicsStatus.TextSize = 12
    GraphicsStatus.TextWrapped = true
    GraphicsStatus.Parent = GraphicsFrame

    -- ========== 高级功能内容 ==========
    local AdvancedFrame = Instance.new("Frame")
    AdvancedFrame.Name = "AdvancedContent"
    AdvancedFrame.Size = UDim2.new(1, 0, 0, 450)
    AdvancedFrame.BackgroundTransparency = 1
    AdvancedFrame.Visible = false
    AdvancedFrame.Parent = ContentContainer

    -- 高级功能标题
    local AdvancedTitle = Instance.new("TextLabel")
    AdvancedTitle.Name = "AdvancedTitle"
    AdvancedTitle.Size = UDim2.new(1, 0, 0, 30)
    AdvancedTitle.Position = UDim2.new(0, 0, 0, 10)
    AdvancedTitle.BackgroundTransparency = 1
    AdvancedTitle.Text = "高级功能设置"
    AdvancedTitle.TextColor3 = Color3.new(1, 1, 1)
    AdvancedTitle.TextSize = 16
    AdvancedTitle.TextWrapped = true
    AdvancedTitle.Parent = AdvancedFrame

    -- 高级功能描述
    local AdvancedDescription = Instance.new("TextLabel")
    AdvancedDescription.Name = "AdvancedDescription"
    AdvancedDescription.Size = UDim2.new(1, -20, 0, 60)
    AdvancedDescription.Position = UDim2.new(0, 10, 0, 50)
    AdvancedDescription.BackgroundTransparency = 1
    AdvancedDescription.Text = "这里是高级功能设置，包含隐身、甩飞、防甩飞等特殊功能。注意：部分功能可能影响游戏平衡，请谨慎使用。"
    AdvancedDescription.TextColor3 = Color3.new(0.8, 0.8, 0.8)
    AdvancedDescription.TextSize = 12
    AdvancedDescription.TextWrapped = true
    AdvancedDescription.Parent = AdvancedFrame

    -- 隐身功能开关按钮
    local InvisibleToggle = Instance.new("TextButton")
    InvisibleToggle.Name = "InvisibleToggle"
    InvisibleToggle.Size = UDim2.new(0.9, 0, 0, 40)
    InvisibleToggle.Position = UDim2.new(0.05, 0, 0, 120)
    InvisibleToggle.BackgroundColor3 = Color3.new(0.3, 0.3, 0.5)
    InvisibleToggle.Text = "隐身功能: 关闭"
    InvisibleToggle.TextColor3 = Color3.new(1, 1, 1)
    InvisibleToggle.TextSize = 14
    InvisibleToggle.BackgroundTransparency = 1

    -- 按钮圆角
    local InvisibleCorner = Instance.new("UICorner")
    InvisibleCorner.CornerRadius = UDim.new(0, 6)
    InvisibleCorner.Parent = InvisibleToggle

    InvisibleToggle.Parent = AdvancedFrame

    -- 甩飞功能
    local ThrowPlayerLabel = Instance.new("TextLabel")
    ThrowPlayerLabel.Name = "ThrowPlayerLabel"
    ThrowPlayerLabel.Size = UDim2.new(0.9, 0, 0, 20)
    ThrowPlayerLabel.Position = UDim2.new(0.05, 0, 0, 170)
    ThrowPlayerLabel.BackgroundTransparency = 1
    ThrowPlayerLabel.Text = "选择要甩飞的玩家:"
    ThrowPlayerLabel.TextColor3 = Color3.new(1, 1, 1)
    ThrowPlayerLabel.TextSize = 12
    ThrowPlayerLabel.TextXAlignment = Enum.TextXAlignment.Left
    ThrowPlayerLabel.Parent = AdvancedFrame

    -- 玩家选择下拉框
    local PlayerDropdown = Instance.new("Frame")
    PlayerDropdown.Name = "PlayerDropdown"
    PlayerDropdown.Size = UDim2.new(0.9, 0, 0, 30)
    PlayerDropdown.Position = UDim2.new(0.05, 0, 0, 195)
    PlayerDropdown.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    PlayerDropdown.BorderSizePixel = 0
    PlayerDropdown.BackgroundTransparency = 1

    local DropdownButton = Instance.new("TextButton")
    DropdownButton.Name = "DropdownButton"
    DropdownButton.Size = UDim2.new(1, 0, 1, 0)
    DropdownButton.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
    DropdownButton.Text = "点击选择玩家"
    DropdownButton.TextColor3 = Color3.new(1, 1, 1)
    DropdownButton.TextSize = 12
    DropdownButton.BackgroundTransparency = 1

    local DropdownCorner = Instance.new("UICorner")
    DropdownCorner.CornerRadius = UDim.new(0, 4)
    DropdownCorner.Parent = DropdownButton

    DropdownButton.Parent = PlayerDropdown
    PlayerDropdown.Parent = AdvancedFrame

    -- 甩飞功能按钮
    local ThrowPlayerBtn = Instance.new("TextButton")
    ThrowPlayerBtn.Name = "ThrowPlayerBtn"
    ThrowPlayerBtn.Size = UDim2.new(0.9, 0, 0, 35)
    ThrowPlayerBtn.Position = UDim2.new(0.05, 0, 0, 235)
    ThrowPlayerBtn.BackgroundColor3 = Color3.new(0.8, 0.3, 0.3)
    ThrowPlayerBtn.Text = "甩飞玩家"
    ThrowPlayerBtn.TextColor3 = Color3.new(1, 1, 1)
    ThrowPlayerBtn.TextSize = 14
    ThrowPlayerBtn.BackgroundTransparency = 1

    -- 按钮圆角
    local ThrowPlayerCorner = Instance.new("UICorner")
    ThrowPlayerCorner.CornerRadius = UDim.new(0, 6)
    ThrowPlayerCorner.Parent = ThrowPlayerBtn

    ThrowPlayerBtn.Parent = AdvancedFrame

    -- 防甩飞功能开关
    local AntiThrowToggle = Instance.new("TextButton")
    AntiThrowToggle.Name = "AntiThrowToggle"
    AntiThrowToggle.Size = UDim2.new(0.9, 0, 0, 40)
    AntiThrowToggle.Position = UDim2.new(0.05, 0, 0, 285)
    AntiThrowToggle.BackgroundColor3 = Color3.new(0.3, 0.5, 0.3)
    AntiThrowToggle.Text = "防甩飞: 关闭"
    AntiThrowToggle.TextColor3 = Color3.new(1, 1, 1)
    AntiThrowToggle.TextSize = 14
    AntiThrowToggle.BackgroundTransparency = 1

    -- 按钮圆角
    local AntiThrowCorner = Instance.new("UICorner")
    AntiThrowCorner.CornerRadius = UDim.new(0, 6)
    AntiThrowCorner.Parent = AntiThrowToggle

    AntiThrowToggle.Parent = AdvancedFrame

    -- 高级功能状态显示
    local AdvancedStatus = Instance.new("TextLabel")
    AdvancedStatus.Name = "AdvancedStatus"
    AdvancedStatus.Size = UDim2.new(1, 0, 0, 80)
    AdvancedStatus.Position = UDim2.new(0, 0, 0, 340)
    AdvancedStatus.BackgroundTransparency = 1
    AdvancedStatus.Text = "高级功能准备就绪\n使用前请先选择玩家"
    AdvancedStatus.TextColor3 = Color3.new(1, 1, 1)
    AdvancedStatus.TextSize = 12
    AdvancedStatus.TextWrapped = true
    AdvancedStatus.Parent = AdvancedFrame

    -- ========== UI淡入动画 ==========
    local function fadeInUI()
        -- 主框架淡入
        TweenService:Create(MainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        -- 标题栏淡入
        TweenService:Create(TitleLabel, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        -- 内容区域淡入
        TweenService:Create(ContentFrame, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        -- 左侧选项栏淡入
        TweenService:Create(LeftOptionsFrame, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        -- 右侧内容区域淡入
        TweenService:Create(RightContentFrame, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        -- 按钮淡入
        wait(0.2)
        TweenService:Create(MinimizeBtn, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        TweenService:Create(CloseBtn, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        -- 选项按钮淡入（逐个）
        local buttons = {Option1Btn, Option2Btn, Option3Btn, Option4Btn, Option5Btn, Option6Btn, Option7Btn}
        for i, button in ipairs(buttons) do
            wait(0.05)
            TweenService:Create(button, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                BackgroundTransparency = 0
            }):Play()
        end
        
        -- 文本框和按钮淡入
        wait(0.2)
        TweenService:Create(SpeedTextBox, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        TweenService:Create(JumpTextBox, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        TweenService:Create(ApplyBtn, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        TweenService:Create(FlyBtn, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        TweenService:Create(HealthRegenBtn, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        TweenService:Create(GodModeBtn, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        TweenService:Create(RegenSpeedTextBox, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        TweenService:Create(RayToggle, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        TweenService:Create(NameToggle, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        TweenService:Create(BoxToggle, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        -- 高级功能按钮淡入
        TweenService:Create(InvisibleToggle, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        TweenService:Create(DropdownButton, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        TweenService:Create(ThrowPlayerBtn, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
        
        TweenService:Create(AntiThrowToggle, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0
        }):Play()
    end

    -- ========== 选项切换逻辑 ==========
    local function resetAllButtons()
        Option1Btn.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
        Option2Btn.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
        Option3Btn.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
        Option4Btn.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
        Option5Btn.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
        Option6Btn.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
        Option7Btn.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
        
        NoticeFrame.Visible = false
        FlyFrame.Visible = false
        SpeedJumpFrame.Visible = false
        HealthRegenFrame.Visible = false
        ESPFrame.Visible = false
        GraphicsFrame.Visible = false
        AdvancedFrame.Visible = false
    end

    Option1Btn.MouseButton1Click:Connect(function()
        resetAllButtons()
        NoticeFrame.Visible = true
        Option1Btn.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
    end)

    Option2Btn.MouseButton1Click:Connect(function()
        resetAllButtons()
        FlyFrame.Visible = true
        Option2Btn.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
    end)

    Option3Btn.MouseButton1Click:Connect(function()
        resetAllButtons()
        SpeedJumpFrame.Visible = true
        Option3Btn.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
    end)

    Option4Btn.MouseButton1Click:Connect(function()
        resetAllButtons()
        HealthRegenFrame.Visible = true
        Option4Btn.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
    end)

    Option5Btn.MouseButton1Click:Connect(function()
        resetAllButtons()
        ESPFrame.Visible = true
        Option5Btn.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
    end)

    Option6Btn.MouseButton1Click:Connect(function()
        resetAllButtons()
        GraphicsFrame.Visible = true
        Option6Btn.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
    end)

    Option7Btn.MouseButton1Click:Connect(function()
        resetAllButtons()
        AdvancedFrame.Visible = true
        Option7Btn.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
    end)

    -- 初始显示公告页面
    resetAllButtons()
    NoticeFrame.Visible = true
    Option1Btn.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)

    -- ========== 关闭按钮功能 ==========
    CloseBtn.MouseButton1Click:Connect(function()
        -- 淡出动画
        TweenService:Create(MainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 1
        }):Play()
        
        wait(0.5)
        ScreenGui:Destroy()
    end)

    -- ========== 最小化按钮功能 ==========
    local isMinimized = false
    MinimizeBtn.MouseButton1Click:Connect(function()
        if isMinimized then
            -- 恢复窗口
            TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                Size = UDim2.new(0, 500, 0, 650)
            }):Play()
            MinimizeBtn.Text = "_"
            isMinimized = false
        else
            -- 最小化窗口
            TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                Size = UDim2.new(0, 500, 0, 30)
            }):Play()
            MinimizeBtn.Text = "□"
            isMinimized = true
        end
    end)

    -- ========== 飞行功能 ==========
    local flying = false
    FlyBtn.MouseButton1Click:Connect(function()
        if not flying then
            -- 执行飞行脚本
            FlyStatus.Text = "飞行功能已激活"
            FlyBtn.Text = "关闭飞行"
            FlyBtn.BackgroundColor3 = Color3.new(0.2, 0.8, 0.2)
            flying = true
            
            -- 加载飞行脚本
            loadstring("\108\111\97\100\115\116\114\105\110\103\40\103\97\109\101\58\72\116\116\112\71\101\116\40\40\39\104\116\116\112\115\58\47\47\103\105\115\116\46\103\105\116\104\117\98\117\115\101\114\99\111\110\116\101\110\116\46\99\111\109\47\109\101\111\122\111\110\101\89\84\47\98\102\48\51\55\100\102\102\57\102\48\97\55\48\48\49\55\51\48\52\100\100\100\54\55\102\100\99\100\51\55\48\47\114\97\119\47\101\49\52\101\55\52\102\52\50\53\98\48\54\48\100\102\53\50\51\51\52\51\99\102\51\48\98\55\56\55\48\55\52\101\98\51\99\53\100\50\47\97\114\99\101\117\115\37\50\53\50\48\120\37\50\53\50\48\102\108\121\37\50\53\50\48\50\37\50\53\50\48\111\98\102\108\117\99\97\116\111\114\39\41\44\116\114\117\101\41\41\40\41\10\10")()
            
        else
            -- 这里可以添加关闭飞行的代码
            FlyStatus.Text = "飞行功能未激活"
            FlyBtn.Text = "开启飞行"
            FlyBtn.BackgroundColor3 = Color3.new(0.3, 0.5, 0.8)
            flying = false
        end
    end)

    -- ========== 速度设置功能 ==========
    local originalWalkSpeed = 16
    local originalJumpHeight = 50

    ApplyBtn.MouseButton1Click:Connect(function()
        local player = Players.LocalPlayer
        local character = player.Character
        local humanoid = character and character:FindFirstChild("Humanoid")
        
        if not humanoid then
            StatusLabel.Text = "错误：找不到Humanoid！"
            StatusLabel.TextColor3 = Color3.new(1, 0, 0)
            wait(3)
            StatusLabel.Text = "等待设置..."
            StatusLabel.TextColor3 = Color3.new(1, 1, 1)
            return
        end
        
        -- 获取输入的值
        local speedValue = tonumber(SpeedTextBox.Text)
        local jumpValue = tonumber(JumpTextBox.Text)
        
        if speedValue and jumpValue then
            -- 设置速度
            humanoid.WalkSpeed = speedValue
            
            -- 设置跳跃高度
            humanoid.JumpHeight = jumpValue
            
            -- 更新原始速度设置
            originalWalkSpeed = speedValue
            originalJumpHeight = jumpValue
            
            -- 显示成功消息
            StatusLabel.Text = "启用成功！速度:" .. speedValue .. " 跳跃:" .. jumpValue
            StatusLabel.TextColor3 = Color3.new(0, 1, 0)
            
            -- 3秒后恢复原状态
            wait(3)
            StatusLabel.Text = "等待设置..."
            StatusLabel.TextColor3 = Color3.new(1, 1, 1)
        else
            -- 显示错误消息
            StatusLabel.Text = "请输入有效的数字！"
            StatusLabel.TextColor3 = Color3.new(1, 0, 0)
            
            -- 3秒后恢复原状态
            wait(3)
            StatusLabel.Text = "等待设置..."
            StatusLabel.TextColor3 = Color3.new(1, 1, 1)
        end
    end)

    -- ========== 无敌模式功能 ==========
    local godModeEnabled = false

    local function applyGodMode()
        local player = Players.LocalPlayer
        
        -- 角色添加时应用无敌
        local function setupCharacter(character)
            if not character then return end
            
            -- 等待角色完全加载
            wait(2)
            
            local humanoid = character:FindFirstChild("Humanoid")
            if not humanoid then
                GodModeStatus.Text = "等待Humanoid加载..."
                GodModeStatus.TextColor3 = Color3.new(1, 1, 0)
                
                local startTime = tick()
                repeat
                    wait(0.1)
                    humanoid = character:FindFirstChild("Humanoid")
                until humanoid or tick() > startTime + 5
                
                if not humanoid then
                    GodModeStatus.Text = "错误：无法找到Humanoid！"
                    GodModeStatus.TextColor3 = Color3.new(1, 0, 0)
                    warn("无法找到Humanoid，无敌模式应用失败")
                    return
                end
            end
            
            -- 防止角色死亡
            humanoid.BreakJointsOnDeath = false
            
            -- 设置最大生命值并防止受伤
            humanoid.MaxHealth = math.huge
            humanoid.Health = math.huge
        end

        -- 设置当前角色
        if player.Character then
            setupCharacter(player.Character)
        end
        
        -- 监听新角色
        player.CharacterAdded:Connect(setupCharacter)
    end

    local function removeGodMode()
        local player = Players.LocalPlayer
        if player.Character then
            local humanoid = player.Character:FindFirstChild("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = originalWalkSpeed
                humanoid.JumpHeight = originalJumpHeight
            end
        end
    end

    GodModeBtn.MouseButton1Click:Connect(function()
        godModeEnabled = not godModeEnabled
        
        if godModeEnabled then
            -- 启用无敌模式
            GodModeBtn.BackgroundColor3 = Color3.new(0.2, 0.8, 0.2)
            GodModeBtn.Text = "无敌模式: 开启"
            GodModeStatus.Text = "无敌模式已激活 - 您现在是无敌状态！"
            GodModeStatus.TextColor3 = Color3.new(0, 1, 0)
            
            -- 保存原始速度设置
            local player = Players.LocalPlayer
            if player.Character then
                local humanoid = player.Character:FindFirstChild("Humanoid")
                if humanoid then
                    originalWalkSpeed = humanoid.WalkSpeed
                    originalJumpHeight = humanoid.JumpHeight
                end
            end
            
            -- 应用无敌效果
            applyGodMode()
            
        else
            -- 关闭无敌模式
            GodModeBtn.BackgroundColor3 = Color3.new(0.8, 0.2, 0.2)
            GodModeBtn.Text = "无敌模式: 关闭"
            GodModeStatus.Text = "无敌模式未激活"
            GodModeStatus.TextColor3 = Color3.new(1, 1, 1)
            
            -- 恢复原始设置
            removeGodMode()
        end
    end)

    -- ========== 血量回复功能 ==========
    local healthRegenEnabled = false
    local regenSpeed = 5
    local regenConnection

    HealthRegenBtn.MouseButton1Click:Connect(function()
        healthRegenEnabled = not healthRegenEnabled
        
        if healthRegenEnabled then
            -- 启用血量回复
            HealthRegenBtn.BackgroundColor3 = Color3.new(0.2, 0.8, 0.2)
            HealthRegenBtn.Text = "血量回复: 开启"
            HealthRegenStatus.Text = "血量回复已激活"
            HealthRegenStatus.TextColor3 = Color3.new(0, 1, 0)
            
            -- 获取回复速度
            local speed = tonumber(RegenSpeedTextBox.Text) or 5
            regenSpeed = speed
            
            -- 启动血量回复循环
            regenConnection = RunService.Heartbeat:Connect(function()
                local player = Players.LocalPlayer
                if player and player.Character then
                    local humanoid = player.Character:FindFirstChild("Humanoid")
                    if humanoid and humanoid.Health > 0 then
                        humanoid.Health = math.min(humanoid.MaxHealth, humanoid.Health + regenSpeed * 0.1)
                    end
                end
            end)
        else
            -- 关闭血量回复
            HealthRegenBtn.BackgroundColor3 = Color3.new(0.8, 0.3, 0.3)
            HealthRegenBtn.Text = "血量回复: 关闭"
            HealthRegenStatus.Text = "血量回复未激活"
            HealthRegenStatus.TextColor3 = Color3.new(1, 1, 1)
            
            -- 断开连接
            if regenConnection then
                regenConnection:Disconnect()
                regenConnection = nil
            end
        end
    end)

    -- ========== 透视功能 ==========
    local rayEnabled = false
    local nameEnabled = false
    local boxEnabled = false
    local espObjects = {}

    -- 创建3D框
    function createBox(character)
        if not character then return end
        
        local humanoid = character:FindFirstChild("Humanoid")
        if not humanoid then return end
        
        -- 删除旧的ESP对象
        if espObjects[character] then
            for _, obj in pairs(espObjects[character]) do
                if obj then
                    obj:Destroy()
                end
            end
        end
        
        espObjects[character] = {}
        
        -- 创建3D框
        if boxEnabled then
            local box = Instance.new("BoxHandleAdornment")
            box.Name = "ESPBox"
            box.Adornee = character
            box.AlwaysOnTop = true
            box.ZIndex = 10
            box.Size = character:GetExtentsSize()
            box.Color3 = Color3.new(1, 0, 0)
            box.Transparency = 0.7
            box.Parent = character
            table.insert(espObjects[character], box)
        end
        
        -- 创建名字标签
        if nameEnabled then
            local head = character:FindFirstChild("Head")
            if head then
                local billboard = Instance.new("BillboardGui")
                billboard.Name = "ESPName"
                billboard.Adornee = head
                billboard.Size = UDim2.new(0, 200, 0, 50)
                billboard.StudsOffset = Vector3.new(0, 3, 0)
                billboard.AlwaysOnTop = true
                
                local nameLabel = Instance.new("TextLabel")
                nameLabel.Size = UDim2.new(1, 0, 1, 0)
                nameLabel.BackgroundTransparency = 1
                nameLabel.Text = character.Name
                nameLabel.TextColor3 = Color3.new(1, 1, 1)
                nameLabel.TextStrokeTransparency = 0
                nameLabel.TextSize = 14
                nameLabel.Font = Enum.Font.SourceSansBold
                nameLabel.Parent = billboard
                
                billboard.Parent = character
                table.insert(espObjects[character], billboard)
            end
        end
        
        -- 创建射线
        if rayEnabled then
            local ray = Instance.new("BoxHandleAdornment")
            ray.Name = "ESPRay"
            ray.Adornee = character
            ray.AlwaysOnTop = true
            ray.ZIndex = 5
            ray.Size = Vector3.new(0.2, 0.2, 100)
            ray.Color3 = Color3.new(0, 1, 0)
            ray.Transparency = 0.5
            ray.Parent = character
            table.insert(espObjects[character], ray)
        end
    end

    -- 更新所有玩家的ESP
    function updateESP()
        -- 清除所有ESP对象
        for character, objects in pairs(espObjects) do
            for _, obj in pairs(objects) do
                if obj then
                    obj:Destroy()
                end
            end
        end
        espObjects = {}
        
        -- 为所有玩家创建ESP
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= Players.LocalPlayer and player.Character then
                createBox(player.Character)
            end
        end
    end

    -- 玩家加入游戏时创建ESP
    Players.PlayerAdded:Connect(function(player)
        player.CharacterAdded:Connect(function(character)
            if rayEnabled or nameEnabled or boxEnabled then
                wait(1)
                createBox(character)
            end
        end)
    end)

    -- 玩家离开游戏时清除ESP
    Players.PlayerRemoving:Connect(function(player)
        if espObjects[player.Character] then
            for _, obj in pairs(espObjects[player.Character]) do
                if obj then
                    obj:Destroy()
                end
            end
            espObjects[player.Character] = nil
        end
    end)

    -- 射线功能开关
    RayToggle.MouseButton1Click:Connect(function()
        rayEnabled = not rayEnabled
        if rayEnabled then
            RayToggle.BackgroundColor3 = Color3.new(0.2, 0.6, 0.2)
            RayToggle.Text = "射线功能: 开启"
            ESPStatus.Text = "射线功能已开启"
        else
            RayToggle.BackgroundColor3 = Color3.new(0.3, 0.3, 0.5)
            RayToggle.Text = "射线功能: 关闭"
            ESPStatus.Text = "射线功能已关闭"
        end
        updateESP()
    end)

    -- 显示名字开关
    NameToggle.MouseButton1Click:Connect(function()
        nameEnabled = not nameEnabled
        if nameEnabled then
            NameToggle.BackgroundColor3 = Color3.new(0.2, 0.6, 0.2)
            NameToggle.Text = "显示名字: 开启"
            ESPStatus.Text = "显示名字功能已开启"
        else
            NameToggle.BackgroundColor3 = Color3.new(0.3, 0.3, 0.5)
            NameToggle.Text = "显示名字: 关闭"
            ESPStatus.Text = "显示名字功能已关闭"
        end
        updateESP()
    end)

    -- 3D框开关
    BoxToggle.MouseButton1Click:Connect(function()
        boxEnabled = not boxEnabled
        if boxEnabled then
            BoxToggle.BackgroundColor3 = Color3.new(0.2, 0.6, 0.2)
            BoxToggle.Text = "3D框: 开启"
            ESPStatus.Text = "3D框功能已开启"
        else
            BoxToggle.BackgroundColor3 = Color3.new(0.3, 0.3, 0.5)
            BoxToggle.Text = "3D框: 关闭"
            ESPStatus.Text = "3D框功能已关闭"
        end
        updateESP()
    end)

    -- ========== 高级功能 - 隐身功能 ==========
    local invisibleEnabled = false
    local invisibleConnection = nil
    
    -- 隐身功能实现
    local function applyInvisibility(enabled)
        local localPlayer = Players.LocalPlayer
        local character = localPlayer.Character or localPlayer.CharacterAdded:Wait()
        
        for _, child in pairs(character:GetChildren()) do
            -- 处理基础部件（身体部位）
            if child:IsA("BasePart") then
                if enabled then
                    child.Transparency = 1  -- 完全透明
                else
                    child.Transparency = 0  -- 完全不透明
                end
                child.CanCollide = not enabled  -- 隐身时不可碰撞
                
            -- 处理配件（帽子、工具等）
            elseif child:IsA("Accessory") then
                local handle = child:FindFirstChild("Handle")
                if handle and handle:IsA("BasePart") then
                    handle.Transparency = enabled and 1 or 0
                end
            end
        end
    end
    
    -- 监听角色变化，重新应用隐身效果
    local function setupInvisibilityListener()
        if invisibleConnection then
            invisibleConnection:Disconnect()
            invisibleConnection = nil
        end
        
        invisibleConnection = Players.LocalPlayer.CharacterAdded:Connect(function(character)
            wait(0.5) -- 等待角色完全加载
            if invisibleEnabled then
                applyInvisibility(true)
            end
        end)
    end
    
    -- 隐身功能开关
    InvisibleToggle.MouseButton1Click:Connect(function()
        invisibleEnabled = not invisibleEnabled
        
        if invisibleEnabled then
            -- 启用隐身
            InvisibleToggle.BackgroundColor3 = Color3.new(0.2, 0.6, 0.2)
            InvisibleToggle.Text = "隐身功能: 开启"
            AdvancedStatus.Text = "隐身功能已激活\n您的人物现在对其他玩家不可见"
            AdvancedStatus.TextColor3 = Color3.new(0, 1, 0)
            
            -- 应用隐身效果
            applyInvisibility(true)
            
            -- 设置监听器
            setupInvisibilityListener()
            
        else
            -- 关闭隐身
            InvisibleToggle.BackgroundColor3 = Color3.new(0.3, 0.3, 0.5)
            InvisibleToggle.Text = "隐身功能: 关闭"
            AdvancedStatus.Text = "隐身功能已关闭\n您的人物恢复正常可见"
            AdvancedStatus.TextColor3 = Color3.new(1, 1, 1)
            
            -- 移除隐身效果
            applyInvisibility(false)
            
            -- 断开监听器
            if invisibleConnection then
                invisibleConnection:Disconnect()
                invisibleConnection = nil
            end
        end
    end)

    -- ========== 高级功能 - 甩飞和防甩飞 ==========
    local selectedPlayer = nil
    local antiThrowEnabled = false
    local antiThrowConnection = nil
    
    -- 更新玩家下拉框
    local function updatePlayerDropdown()
        local players = Players:GetPlayers()
        local playerNames = {}
        
        for _, player in ipairs(players) do
            if player ~= Players.LocalPlayer then
                table.insert(playerNames, player.Name)
            end
        end
        
        if #playerNames > 0 then
            DropdownButton.Text = "选择玩家 (" .. #playerNames .. " 个在线)"
        else
            DropdownButton.Text = "没有其他玩家"
            selectedPlayer = nil
        end
    end
    
    -- 创建玩家选择界面
    local function createPlayerSelection()
        local selectionFrame = Instance.new("Frame")
        selectionFrame.Name = "PlayerSelection"
        selectionFrame.Size = UDim2.new(0.9, 0, 0, 200)
        selectionFrame.Position = UDim2.new(0.05, 0, 0, 230)
        selectionFrame.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
        selectionFrame.BorderSizePixel = 0
        
        local selectionCorner = Instance.new("UICorner")
        selectionCorner.CornerRadius = UDim.new(0, 6)
        selectionCorner.Parent = selectionFrame
        
        local selectionScroll = Instance.new("ScrollingFrame")
        selectionScroll.Name = "SelectionScroll"
        selectionScroll.Size = UDim2.new(1, -10, 1, -10)
        selectionScroll.Position = UDim2.new(0, 5, 0, 5)
        selectionScroll.BackgroundTransparency = 1
        selectionScroll.BorderSizePixel = 0
        selectionScroll.ScrollBarThickness = 6
        selectionScroll.AutomaticCanvasSize = Enum.AutomaticSize.Y
        
        local selectionLayout = Instance.new("UIListLayout")
        selectionLayout.Padding = UDim.new(0, 5)
        selectionLayout.SortOrder = Enum.SortOrder.LayoutOrder
        
        selectionScroll.Parent = selectionFrame
        selectionLayout.Parent = selectionScroll
        
        -- 添加玩家按钮
        local players = Players:GetPlayers()
        local yOffset = 0
        
        for _, player in ipairs(players) do
            if player ~= Players.LocalPlayer then
                local playerBtn = Instance.new("TextButton")
                playerBtn.Size = UDim2.new(1, 0, 0, 30)
                playerBtn.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
                playerBtn.Text = player.Name
                playerBtn.TextColor3 = Color3.new(1, 1, 1)
                playerBtn.TextSize = 12
                
                local playerBtnCorner = Instance.new("UICorner")
                playerBtnCorner.CornerRadius = UDim.new(0, 4)
                playerBtnCorner.Parent = playerBtn
                
                playerBtn.MouseButton1Click:Connect(function()
                    selectedPlayer = player
                    DropdownButton.Text = "已选择: " .. player.Name
                    AdvancedStatus.Text = "已选择玩家: " .. player.Name .. "\n点击'甩飞玩家'按钮开始甩飞"
                    selectionFrame:Destroy()
                end)
                
                playerBtn.Parent = selectionScroll
            end
        end
        
        selectionFrame.Parent = AdvancedFrame
        
        -- 点击外部关闭
        local closeConnection
        closeConnection = UserInputService.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                if selectionFrame and selectionFrame.Parent then
                    local mousePos = UserInputService:GetMouseLocation()
                    local framePos = selectionFrame.AbsolutePosition
                    local frameSize = selectionFrame.AbsoluteSize
                    
                    if mousePos.X < framePos.X or mousePos.X > framePos.X + frameSize.X or
                       mousePos.Y < framePos.Y or mousePos.Y > framePos.Y + frameSize.Y then
                        selectionFrame:Destroy()
                        closeConnection:Disconnect()
                    end
                end
            end
        end)
    end
    
    -- 甩飞玩家功能
    ThrowPlayerBtn.MouseButton1Click:Connect(function()
        if selectedPlayer and selectedPlayer.Character then
            local targetCharacter = selectedPlayer.Character
            local humanoidRootPart = targetCharacter:FindFirstChild("HumanoidRootPart")
            
            if humanoidRootPart then
                AdvancedStatus.Text = "正在甩飞玩家: " .. selectedPlayer.Name
                AdvancedStatus.TextColor3 = Color3.new(0, 1, 0)
                
                -- 创建一个强力向后的冲力
                local bodyVelocity = Instance.new("BodyVelocity")
                bodyVelocity.Velocity = Vector3.new(0, 100, 0) -- 向上甩飞
                bodyVelocity.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
                bodyVelocity.P = 10000
                
                -- 创建一个旋转力
                local bodyAngularVelocity = Instance.new("BodyAngularVelocity")
                bodyAngularVelocity.AngularVelocity = Vector3.new(20, 20, 20) -- 快速旋转
                bodyAngularVelocity.MaxTorque = Vector3.new(math.huge, math.huge, math.huge)
                bodyAngularVelocity.P = 10000
                
                -- 应用冲力
                bodyVelocity.Parent = humanoidRootPart
                bodyAngularVelocity.Parent = humanoidRootPart
                
                -- 5秒后移除冲力
                wait(5)
                if bodyVelocity and bodyVelocity.Parent then
                    bodyVelocity:Destroy()
                end
                if bodyAngularVelocity and bodyAngularVelocity.Parent then
                    bodyAngularVelocity:Destroy()
                end
                
                AdvancedStatus.Text = "甩飞完成: " .. selectedPlayer.Name .. " 已被甩飞！"
                
                -- 3秒后恢复原状态
                wait(3)
                AdvancedStatus.Text = "高级功能准备就绪\n使用前请先选择玩家"
                AdvancedStatus.TextColor3 = Color3.new(1, 1, 1)
            else
                AdvancedStatus.Text = "错误：找不到目标玩家的HumanoidRootPart！"
                AdvancedStatus.TextColor3 = Color3.new(1, 0, 0)
                wait(3)
                AdvancedStatus.Text = "高级功能准备就绪\n使用前请先选择玩家"
                AdvancedStatus.TextColor3 = Color3.new(1, 1, 1)
            end
        else
            AdvancedStatus.Text = "错误：请先选择玩家或玩家不在线！"
            AdvancedStatus.TextColor3 = Color3.new(1, 0, 0)
            wait(3)
            AdvancedStatus.Text = "高级功能准备就绪\n使用前请先选择玩家"
            AdvancedStatus.TextColor3 = Color3.new(1, 1, 1)
        end
    end)
    
    -- 防甩飞功能
    local function setupAntiThrow()
        local localPlayer = Players.LocalPlayer
        
        -- 防甩飞核心功能
        local function protectFromThrow(character)
            if not character then return end
            
            wait(1) -- 等待角色加载
            
            local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
            if not humanoidRootPart then
                -- 如果还没有HumanoidRootPart，等待一下
                local startTime = tick()
                repeat
                    wait(0.1)
                    humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
                until humanoidRootPart or tick() > startTime + 3
                
                if not humanoidRootPart then
                    warn("防甩飞：找不到HumanoidRootPart")
                    return
                end
            end
            
            -- 创建防护力
            local antiForce = Instance.new("BodyPosition")
            antiForce.Name = "AntiThrowForce"
            antiForce.Position = humanoidRootPart.Position
            antiForce.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
            antiForce.P = 100000
            antiForce.D = 1000
            
            -- 创建防旋转力
            local antiRotation = Instance.new("BodyGyro")
            antiRotation.Name = "AntiThrowGyro"
            antiRotation.MaxTorque = Vector3.new(math.huge, math.huge, math.huge)
            antiRotation.P = 100000
            antiRotation.D = 1000
            
            -- 应用防护力
            antiForce.Parent = humanoidRootPart
            antiRotation.Parent = humanoidRootPart
            
            -- 持续更新位置，防止被甩飞
            local protectionConnection
            protectionConnection = RunService.Heartbeat:Connect(function()
                if antiForce and antiForce.Parent and humanoidRootPart then
                    -- 保持当前位置
                    antiForce.Position = humanoidRootPart.Position
                    
                    -- 防止被施加冲力
                    local bodyVelocities = humanoidRootPart:GetChildren()
                    for _, child in ipairs(bodyVelocities) do
                        if child:IsA("BodyVelocity") or child:IsA("BodyAngularVelocity") then
                            -- 削弱或移除外来冲力
                            child:Destroy()
                        end
                    end
                else
                    -- 如果防护力被移除，重新创建
                    if protectionConnection then
                        protectionConnection:Disconnect()
                    end
                    if antiThrowEnabled then
                        protectFromThrow(character)
                    end
                end
            end)
            
            -- 监听外来冲力
            humanoidRootPart.ChildAdded:Connect(function(child)
                if antiThrowEnabled and (child:IsA("BodyVelocity") or child:IsA("BodyAngularVelocity")) then
                    wait(0.05) -- 短暂延迟后移除
                    if child and child.Parent then
                        child:Destroy()
                        AdvancedStatus.Text = "检测到甩飞尝试，已防护！"
                        AdvancedStatus.TextColor3 = Color3.new(0, 1, 0)
                        wait(2)
                        AdvancedStatus.Text = "防甩飞功能已激活\n您现在不会被甩飞"
                        AdvancedStatus.TextColor3 = Color3.new(0, 1, 0)
                    end
                end
            end)
            
            return antiForce, antiRotation
        end
        
        -- 设置当前角色防护
        local antiForce, antiRotation
        if localPlayer.Character then
            antiForce, antiRotation = protectFromThrow(localPlayer.Character)
        end
        
        -- 监听新角色
        localPlayer.CharacterAdded:Connect(function(character)
            if antiThrowEnabled then
                wait(1)
                antiForce, antiRotation = protectFromThrow(character)
            end
        end)
        
        return function()
            -- 关闭防护功能
            if antiForce and antiForce.Parent then
                antiForce:Destroy()
            end
            if antiRotation and antiRotation.Parent then
                antiRotation:Destroy()
            end
        end
    end
    
    -- 防甩飞开关
    AntiThrowToggle.MouseButton1Click:Connect(function()
        antiThrowEnabled = not antiThrowEnabled
        
        if antiThrowEnabled then
            -- 启用防甩飞
            AntiThrowToggle.BackgroundColor3 = Color3.new(0.2, 0.8, 0.2)
            AntiThrowToggle.Text = "防甩飞: 开启"
            AdvancedStatus.Text = "防甩飞功能已激活\n您现在不会被甩飞"
            AdvancedStatus.TextColor3 = Color3.new(0, 1, 0)
            
            -- 设置防甩飞
            if antiThrowConnection then
                antiThrowConnection()
            end
            antiThrowConnection = setupAntiThrow()
            
        else
            -- 关闭防甩飞
            AntiThrowToggle.BackgroundColor3 = Color3.new(0.3, 0.5, 0.3)
            AntiThrowToggle.Text = "防甩飞: 关闭"
            AdvancedStatus.Text = "防甩飞功能已关闭\n您现在可以被甩飞"
            AdvancedStatus.TextColor3 = Color3.new(1, 1, 1)
            
            -- 移除防甩飞
            if antiThrowConnection then
                antiThrowConnection()
                antiThrowConnection = nil
            end
        end
    end)
    
    -- 玩家选择下拉框点击事件
    DropdownButton.MouseButton1Click:Connect(function()
        createPlayerSelection()
    end)
    
    -- 初始化玩家列表
    updatePlayerDropdown()
    
    -- 监听玩家加入/离开
    Players.PlayerAdded:Connect(updatePlayerDropdown)
    Players.PlayerRemoving:Connect(updatePlayerDropdown)

    -- ========== UI拖动功能 ==========
    local isDragging = false
    local dragStartPos = Vector2.new()
    local frameStartPos = UDim2.new()

    TitleLabel.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            isDragging = true
            dragStartPos = input.Position
            frameStartPos = MainFrame.Position
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if isDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStartPos
            MainFrame.Position = UDim2.new(
                frameStartPos.X.Scale,
                frameStartPos.X.Offset + delta.X,
                frameStartPos.Y.Scale,
                frameStartPos.Y.Offset + delta.Y
            )
        end
    end)

    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            isDragging = false
        end
    end)

    -- ========== 主UI显示 ==========
    -- 执行UI淡入动画
    wait(0.5)
    fadeInUI()

    print("XH脚本主界面创建完成！")
    
    return ScreenGui
end

-- ========== 主执行流程 ==========
print("开始执行XH脚本...")

-- 播放启动动画
local playAnimation = createStartupAnimation()
local animationSuccess = pcall(playAnimation)

if not animationSuccess then
    warn("启动动画播放失败，继续执行...")
end

wait(0.5)

-- 创建主UI
local mainUI = createMainUI()

print("XH脚本加载完成！总耗时: " .. (tick() - Start) .. " 秒")
